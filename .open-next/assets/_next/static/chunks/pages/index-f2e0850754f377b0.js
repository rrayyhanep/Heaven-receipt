(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1854)}])},1854:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(5893),n=t(7294),r=t(9008),o=t.n(r),i=t(4609),s=t.n(i),c=t(1163);function d(){let[e,a]=(0,n.useState)([]),[t,r]=(0,n.useState)(""),[i,d]=(0,n.useState)(""),[u,m]=(0,n.useState)("0"),[h,p]=(0,n.useState)("0"),[f,y]=(0,n.useState)("0"),[v,_]=(0,n.useState)("0"),x=(0,c.useRouter)();(0,n.useEffect)(()=>{j();let e=new Date;d(e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0"))},[]),(0,n.useEffect)(()=>{let a=e.find(e=>e.id===t);if(a){var l,n;y((null===(l=a.basicSalary)||void 0===l?void 0:l.toString())||"0"),_((null===(n=a.pendingBalance)||void 0===n?void 0:n.toString())||"0")}else y("0"),_("0")},[t,e]);let j=async()=>{try{let e=await fetch("/api/employees"),t=await e.json();a(t)}catch(e){console.error("Failed to fetch employees:",e),alert("Could not fetch employees. Please check the network or API status.")}},b=async e=>{if(e.preventDefault(),!t){alert("Please select an employee.");return}let a={employeeId:t,monthYear:i,advance:parseFloat(u)||0,leaveDeduction:parseFloat(h)||0};try{let e=await fetch("/api/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(e.ok){let a=await e.blob(),l=window.URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download="salary_slip_".concat(t,"_").concat(i,".pdf"),document.body.appendChild(n),n.click(),n.remove(),j(),m("0"),p("0")}else{let a=await e.text();alert("Failed to generate PDF: ".concat(a))}}catch(e){console.error("PDF Generation Error:",e),alert("An error occurred while trying to generate the PDF.")}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o(),{children:(0,l.jsx)("title",{children:"Salary Slip Generator"})}),(0,l.jsxs)("div",{className:s().card,children:[(0,l.jsx)("h1",{className:s().title,children:"Salary Slip Generator"}),(0,l.jsxs)("form",{onSubmit:b,className:s().form,children:[(0,l.jsxs)("div",{className:"".concat(s().formGroup," ").concat(s().fullWidth),children:[(0,l.jsx)("label",{htmlFor:"employee",children:"Select Employee"}),(0,l.jsxs)("select",{id:"employee",value:t,onChange:e=>r(e.target.value),required:!0,children:[(0,l.jsx)("option",{value:"",disabled:!0,children:"Select an employee"}),e.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:s().formGroup,children:[(0,l.jsx)("label",{htmlFor:"monthYear",children:"Salary Month"}),(0,l.jsx)("input",{type:"month",id:"monthYear",value:i,onChange:e=>d(e.target.value),required:!0})]}),(0,l.jsxs)("div",{className:s().formGroup,children:[(0,l.jsx)("label",{htmlFor:"basicSalary",children:"Basic Salary"}),(0,l.jsx)("input",{type:"text",id:"basicSalary",value:"₹".concat(f),readOnly:!0,className:s().readOnly})]}),(0,l.jsxs)("div",{className:s().formGroup,children:[(0,l.jsx)("label",{htmlFor:"pendingBalance",children:"Old Balance"}),(0,l.jsx)("input",{type:"text",id:"pendingBalance",value:"₹".concat(v),readOnly:!0,className:s().readOnly})]}),(0,l.jsxs)("div",{className:s().formGroup,children:[(0,l.jsx)("label",{htmlFor:"advance",children:"Advance Taken"}),(0,l.jsx)("input",{type:"number",id:"advance",value:u,onChange:e=>m(e.target.value),placeholder:"0.00"})]}),(0,l.jsxs)("div",{className:s().formGroup,children:[(0,l.jsx)("label",{htmlFor:"leaveDeduction",children:"Leave Deduction"}),(0,l.jsx)("input",{type:"number",id:"leaveDeduction",value:h,onChange:e=>p(e.target.value),placeholder:"0.00"})]}),(0,l.jsx)("button",{type:"submit",className:s().button,children:"Generate & Download Salary Slip"})]}),(0,l.jsx)("button",{onClick:()=>x.push("/employees"),className:s().button,style:{marginTop:"1.5rem"},children:"Manage Employees"})]})]})}},4609:function(e){e.exports={card:"Home_card__E5spL",title:"Home_title__hYX6j",form:"Home_form__FrVR9",formGroup:"Home_formGroup__KFkHd",readOnly:"Home_readOnly__Ji2vV",fullWidth:"Home_fullWidth__mol2w",button:"Home_button__G93Ef"}},9008:function(e,a,t){e.exports=t(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);